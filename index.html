<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<style>
  #canvas {
    background-color: white;
  }

  body {
    background-color: gray;
  }

  main {
    background-color: coral;
    padding-left: 15px;
    height: calc(100vh - 50px);
  }

  #holder {
    background-color: burlywood;
    width: calc(100vw - 130px);
    height: calc(100vh - 200px);
    display: inline-block;
  }

  header {
    height: 50px;
    background-color: chartreuse;
  }

  #colorpicker {
    width: 94px;
    height: calc(100vh - 200px);
    background-color: cornflowerblue;
    display: inline-block;
    padding: 20px;
    box-sizing: border-box;
  }

  #sliderholder {
    width: calc(100% - 17px);
    height: 140px;
    background-color: darkblue;
  }

  .m-0 {
    margin: 0 !important;
  }

  .options {
    border-radius: 50%;
    border: 2px solid black;
    height: 50px;
    width: 50px;
    margin-bottom: 20px;
  }
</style>

<body class="m-0">
  <header class="m-0">Drawing App that Draws</header>
  <main class="m-0">
    <div class="m-0" id="holder">
      <canvas id="canvas"></canvas>
    </div>
    <div class="m-0" id="colorpicker">
      <div class="options"></div>
      <div class="options"></div>
      <div class="options"></div>
    </div>
    <div class="m-0" id="sliderholder">
      <div class="slidecontainer">
        <input type="range" min="0" max="255" value="77" class="slider" id="customred">
        <input type="range" min="0" max="255" value="20" class="slider" id="customgreen">
        <input type="range" min="0" max="255" value="140" class="slider" id="customblue">
      </div>Red:<span id="redvalue"></span>Green:<span id="greenvalue"></span>Blue:<span id="bluevalue"></span>
      <div><button id="colormaker">MAKE COLOR</button><button id="reset">WIPE</button></div>
    </div>
  </main>

</body>
<script>
  let canvas = document.getElementById("canvas");
  let ctx = canvas.getContext('2d');
  let pos = { x: 0, y: 0 };
  let drawcolor = [0, 0, 0];
  let customcolor = []

  window.addEventListener('resize', resize);
  document.addEventListener('mousemove', draw);
  document.addEventListener('mousedown', setPosition);
  document.addEventListener('mouseenter', setPosition);

  function setPosition(e) {
    pos.x = e.clientX - 15;
    pos.y = e.clientY - 50;
  }

  function resize() {
    let holder = document.getElementById("holder");
    ctx.canvas.width = holder.clientWidth;
    ctx.canvas.height = holder.clientHeight;
  }

  function draw(e) {
    if (e.buttons !== 1) return;
    ctx.beginPath();
    ctx.lineWidth = 5;
    ctx.lineCap = 'round';
    ctx.strokeStyle = `rgb( ${drawcolor[0]},${drawcolor[1]},${drawcolor[2]})`;
    ctx.moveTo(pos.x, pos.y);
    setPosition(e);
    ctx.lineTo(pos.x, pos.y);
    ctx.stroke();
  }

  (function () {
    let white = [255, 255, 255];
    let black = [0, 0, 0];
    customcolor = [];
    let startcolors = document.getElementsByClassName("options");

    for (let i = 0; i < 3; i++) {
      customcolor = Object.assign(customcolor, black);
      customcolor[i] = white[i];
      startcolors[i].style.backgroundColor = `rgb(${customcolor[0]},${customcolor[1]},${customcolor[2]})`
      const mycolor = [];
      Object.assign(mycolor, customcolor);
      startcolors[i].addEventListener("click", function () {
        drawcolor = mycolor;
      })
    }
  })()

  let redslider = document.getElementById("customred");
  let greenslider = document.getElementById("customgreen");
  let blueslider = document.getElementById("customblue");
  customcolor = [77, 20, 140]
  let redfeedback = document.getElementById("redvalue");
  let greenfeedback = document.getElementById("greenvalue");
  let bluefeedback = document.getElementById("bluevalue");

  redfeedback.innerHTML = redslider.value;
  redslider.oninput = function () {
    redfeedback.innerHTML = this.value;
    customcolor[0] = this.value;
  }

  greenfeedback.innerHTML = greenslider.value;
  greenslider.oninput = function () {
    greenfeedback.innerHTML = this.value;
    customcolor[1] = this.value;
  }

  bluefeedback.innerHTML = blueslider.value;
  blueslider.oninput = function () {
    bluefeedback.innerHTML = this.value;
    customcolor[2] = this.value;
  }
  
  const makecolor = [];
  document.getElementById("colormaker").addEventListener("click", function () {
    Object.assign(makecolor, customcolor);
    console.log(`makecolor is ${makecolor}`)
    let nextcircle = document.createElement("div");
    let circleholder = document.getElementById("colorpicker");
    circleholder.appendChild(nextcircle);
    console.log("added div")
    nextcircle.classList.add("options");
    console.log("added class")
    nextcircle.style.backgroundColor = `rgb(${makecolor[0]},${makecolor[1]},${makecolor[2]})`
    console.log("set background color")
    nextcircle.addEventListener("click",function() {
      drawcolor = makecolor;
    })
  })

  resize();
</script>

</html>